# Admin Management Scripts

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## å‰ææ¡ä»¶

1. `.env.local`ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨
2. Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«`admins`ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨
3. `tenants`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ†ãƒŠãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã“ã¨

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§

### ğŸ“‹ ç®¡ç†è€…ä¸€è¦§è¡¨ç¤º

```bash
npm run admin:list
# ã¾ãŸã¯
node scripts/list-admins.mjs
```

ç¾åœ¨ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å…¨ã¦ã®ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

### ğŸ‘¤ ç®¡ç†è€…ä½œæˆ

```bash
npm run admin:create <tenant_id> <username> <password> <name>
# ã¾ãŸã¯
node scripts/create-admin.mjs <tenant_id> <username> <password> <name>
```

æ–°ã—ã„ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `tenant_id`: ãƒ†ãƒŠãƒ³ãƒˆã®UUIDï¼ˆtenantsãƒ†ãƒ¼ãƒ–ãƒ«ã«å­˜åœ¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰
- `username`: ãƒ­ã‚°ã‚¤ãƒ³ç”¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆ3-50æ–‡å­—ã€ä¸€æ„ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰
- `password`: ãƒ­ã‚°ã‚¤ãƒ³ç”¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ6æ–‡å­—ä»¥ä¸Šï¼‰
- `name`: ç®¡ç†è€…ã®è¡¨ç¤ºå

**ä¾‹:**
```bash
npm run admin:create "550e8400-e29b-41d4-a716-446655440000" "admin" "securePassword123" "ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…"
# ã¾ãŸã¯
node scripts/create-admin.mjs "550e8400-e29b-41d4-a716-446655440000" "admin" "securePassword123" "ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…"
```

### ğŸ—‘ï¸ ç®¡ç†è€…å‰Šé™¤

```bash
CONFIRM_DELETE=yes npm run admin:delete <username>
# ã¾ãŸã¯
CONFIRM_DELETE=yes node scripts/delete-admin.mjs <username>
```

æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼åã®ç®¡ç†è€…ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `username`: å‰Šé™¤ã™ã‚‹ç®¡ç†è€…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å

**ä¾‹:**
```bash
CONFIRM_DELETE=yes npm run admin:delete admin
# ã¾ãŸã¯
CONFIRM_DELETE=yes node scripts/delete-admin.mjs admin
```

âš ï¸ **æ³¨æ„**: å‰Šé™¤ã¯å–ã‚Šæ¶ˆã—ã§ãã¾ã›ã‚“ã€‚`CONFIRM_DELETE=yes`ç’°å¢ƒå¤‰æ•°ãŒå¿…è¦ã§ã™ã€‚

## ä½¿ç”¨ä¾‹

### 1. æ—¢å­˜ã®ç®¡ç†è€…ã‚’ç¢ºèª
```bash
npm run admin:list
```

### 2. æ–°ã—ã„ç®¡ç†è€…ã‚’ä½œæˆ
```bash
# ç®¡ç†è€…ã‚’ä½œæˆ
npm run admin:create "your-tenant-id" "admin" "password123" "ç®¡ç†è€…"
```

### 3. ç®¡ç†è€…ã§ãƒ­ã‚°ã‚¤ãƒ³
ãƒ–ãƒ©ã‚¦ã‚¶ã§ `/admin/login` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ä½œæˆã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚

### 4. ä¸è¦ãªç®¡ç†è€…ã‚’å‰Šé™¤
```bash
CONFIRM_DELETE=yes npm run admin:delete old-admin
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼

**ç’°å¢ƒå¤‰æ•°ã‚¨ãƒ©ãƒ¼**
```
âŒ Error: NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables are required
```
â†’ `.env.local`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„

**ãƒ†ãƒŠãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„**
```
âŒ Error: Tenant not found. Please check the tenant_id.
```
â†’ æ­£ã—ã„ãƒ†ãƒŠãƒ³ãƒˆIDã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„

**ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒé‡è¤‡**
```
âŒ Error: Username 'admin' already exists
```
â†’ ç•°ãªã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„

### ãƒ‡ãƒãƒƒã‚°

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è©³ç´°ãªå®Ÿè¡Œãƒ­ã‚°ã‚’ç¢ºèªã—ãŸã„å ´åˆ:

```bash
DEBUG=true npm run admin:create ...
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„äº‹é …

1. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å¼·åº¦**: æœ¬ç•ªç’°å¢ƒã§ã¯å¼·å›ºãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„
2. **ç’°å¢ƒå¤‰æ•°ã®ä¿è­·**: `.env.local`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã«å«ã‚ãªã„ã§ãã ã•ã„
3. **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™**: ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ç®¡ç†è€…ã®ã¿ãŒå®Ÿè¡Œã§ãã‚‹ç’°å¢ƒã§ä½¿ç”¨ã—ã¦ãã ã•ã„
4. **ãƒ­ã‚°ã®ç®¡ç†**: å®Ÿè¡Œãƒ­ã‚°ã«æ©Ÿå¯†æƒ…å ±ãŒå«ã¾ã‚Œãªã„ã‚ˆã†æ³¨æ„ã—ã¦ãã ã•ã„